facltnm
tel
first_img
reserve_str_date
reserve_end_date





















@GetMapping("/payCheck/{reserve_idx}")
    public ModelAndView payCheck(@PathVariable("reserve_idx")int reserve_idx, HttpServletRequest request, HttpSession session) {
        ModelAndView mav = new ModelAndView("/reserve/payCheck");
        ReserveDTO reservedto = reserveService.reserveOne(reserve_idx);
        if(session.getAttribute("login") == null) {
            mav.setViewName("/alert");
            mav.addObject("msg", "로그인 후 이용해주세요");
            mav.addObject("url", "home");
            return mav;
        }

        int price = Integer.parseInt(request.getParameter("price"));
        int payRow = reserveService.paymentByOne(reserve_idx);
//        int minRow = reserveService.minuseSiteCo(reservedto);

        //총 결제금액 추가 
        HashMap<String, Object> param = new HashMap<String, Object>();
        param.put("reservedto", reservedto);
        param.put("reserve_idx", reserve_idx);
        param.put("price", price);

        int priceRow = reserveService.totalPrice(param);

        System.out.println(payRow != 0  ? "결제상태 업뎃" : "결제업뎃실패"  );
        System.out.println(priceRow != 0 ? "총금액 업뎃 " : "총금액 업뎃실패");
        mav.addObject("reservedto",reservedto);
        mav.addObject("price",price);
        return mav;
    }








select
        *
        from
        reserve r
        join user_table ut on r.user_idx = ut.user_idx
        join camping c on r.camping_idx = c.camping_idx
        where
        r.reserve_idx = #{reserve_idx}

<select id="reserveOne" resultType="reserve" parameterType="int">
        select
        *
        from
        reserve r
        join user_table ut on r.user_idx = ut.user_idx
        join camping c on r.camping_idx = c.camping_idx
        where
        r.reserve_idx = #{reserve_idx}
</select>

